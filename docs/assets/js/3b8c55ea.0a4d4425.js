"use strict";(self.webpackChunkdocumentation_site=self.webpackChunkdocumentation_site||[]).push([[6803],{6845:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>c,contentTitle:()=>d,default:()=>u,frontMatter:()=>r,metadata:()=>l,toc:()=>a});var o=i(4848),s=i(8453);const r={id:"installation",title:"Installation",sidebar_label:"Installation"},d="Installation",l={id:"installation",title:"Installation",description:"Installing the library",source:"@site/docs/installation.md",sourceDirName:".",slug:"/installation",permalink:"/expo-audio-stream/docs/installation",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{id:"installation",title:"Installation",sidebar_label:"Installation"},sidebar:"tutorialSidebar",previous:{title:"Features",permalink:"/expo-audio-stream/docs/features"},next:{title:"Standalone Recording",permalink:"/expo-audio-stream/docs/usage/standalone-recording"}},c={},a=[{value:"Installing the library",id:"installing-the-library",level:2},{value:"Configuring with app.json",id:"configuring-with-appjson",level:2},{value:"Basic Configuration",id:"basic-configuration",level:3},{value:"Advanced Configuration",id:"advanced-configuration",level:3},{value:"Configuration Options",id:"configuration-options",level:3},{value:"Core Options",id:"core-options",level:4},{value:"iOS Background Modes",id:"ios-background-modes",level:4},{value:"iOS Specific Configuration",id:"ios-specific-configuration",level:4},{value:"Android Specific Configuration",id:"android-specific-configuration",level:4},{value:"Android Manifest Permissions",id:"android-manifest-permissions",level:3},{value:"Android Service Components",id:"android-service-components",level:3},{value:"App Store Submission Notes",id:"app-store-submission-notes",level:3},{value:"Requesting Permissions",id:"requesting-permissions",level:2}];function t(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.h1,{id:"installation",children:"Installation"}),"\n",(0,o.jsx)(e.h2,{id:"installing-the-library",children:"Installing the library"}),"\n",(0,o.jsxs)(e.p,{children:["To install ",(0,o.jsx)(e.code,{children:"@siteed/expo-audio-stream"}),", add it to your project using npm or Yarn:"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-bash",children:"npm install @siteed/expo-audio-stream\n# or\nyarn add @siteed/expo-audio-stream\n"})}),"\n",(0,o.jsx)(e.h2,{id:"configuring-with-appjson",children:"Configuring with app.json"}),"\n",(0,o.jsx)(e.p,{children:"To ensure expo-audio-stream works correctly with Expo, you must add it as a plugin in your app.json configuration file. You can add it with default configuration or customize its behavior using options:"}),"\n",(0,o.jsx)(e.h3,{id:"basic-configuration",children:"Basic Configuration"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-json",children:'{\n    "expo": {\n        "plugins": ["@siteed/expo-audio-stream"]\n    }\n}\n'})}),"\n",(0,o.jsx)(e.h3,{id:"advanced-configuration",children:"Advanced Configuration"}),"\n",(0,o.jsx)(e.p,{children:"You can customize the plugin's behavior by providing options:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-json",children:'{\n    "expo": {\n        "plugins": [\n            [\n                "@siteed/expo-audio-stream",\n                {\n                    "enablePhoneStateHandling": true,\n                    "enableNotifications": true,\n                    "enableBackgroundAudio": true,\n                    "iosBackgroundModes": {\n                        "useVoIP": false,\n                        "useAudio": false,\n                        "useProcessing": true\n                    },\n                    "iosConfig": {\n                        "backgroundProcessingTitle": "Audio Recording",\n                        "keepAliveInBackground": true\n                    }\n                }\n            ]\n        ]\n    }\n}\n'})}),"\n",(0,o.jsx)(e.h3,{id:"configuration-options",children:"Configuration Options"}),"\n",(0,o.jsx)(e.h4,{id:"core-options",children:"Core Options"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsxs)(e.p,{children:[(0,o.jsx)(e.strong,{children:"enablePhoneStateHandling"})," (default: ",(0,o.jsx)(e.code,{children:"true"}),"):"]}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"Enables handling of phone state changes (calls, etc.)"}),"\n",(0,o.jsx)(e.li,{children:"Adds telephony capabilities on iOS"}),"\n",(0,o.jsx)(e.li,{children:"Adds READ_PHONE_STATE permission on Android"}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsxs)(e.p,{children:[(0,o.jsx)(e.strong,{children:"enableNotifications"})," (default: ",(0,o.jsx)(e.code,{children:"true"}),"):"]}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"Enables recording notifications and controls"}),"\n",(0,o.jsx)(e.li,{children:"Adds notification permissions on both platforms"}),"\n",(0,o.jsx)(e.li,{children:"Adds POST_NOTIFICATIONS permission on Android"}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsxs)(e.p,{children:[(0,o.jsx)(e.strong,{children:"enableBackgroundAudio"})," (default: ",(0,o.jsx)(e.code,{children:"true"}),"):"]}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"Enables background audio recording capabilities"}),"\n",(0,o.jsx)(e.li,{children:"Adds FOREGROUND_SERVICE and FOREGROUND_SERVICE_MICROPHONE permissions on Android"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(e.h4,{id:"ios-background-modes",children:"iOS Background Modes"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"iosBackgroundModes"}),":","\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"useVoIP"})," (default: ",(0,o.jsx)(e.code,{children:"false"}),"): Enable VoIP background mode"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"useAudio"})," (default: ",(0,o.jsx)(e.code,{children:"false"}),"): Enable audio background mode"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"useProcessing"})," (default: ",(0,o.jsx)(e.code,{children:"false"}),"): Enable background processing mode"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"useLocation"})," (default: ",(0,o.jsx)(e.code,{children:"false"}),"): Enable location updates in background"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"useExternalAccessory"})," (default: ",(0,o.jsx)(e.code,{children:"false"}),"): Enable external audio accessories"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(e.h4,{id:"ios-specific-configuration",children:"iOS Specific Configuration"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"iosConfig"}),":","\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"allowBackgroundAudioControls"})," (default: ",(0,o.jsx)(e.code,{children:"false"}),"): Show audio controls in control center"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"backgroundProcessingTitle"})," (default: ",(0,o.jsx)(e.code,{children:"'Audio Recording'"}),"): Description for background processing"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"keepAliveInBackground"})," (default: ",(0,o.jsx)(e.code,{children:"true"}),"): Enable background keep-alive mechanisms"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(e.h4,{id:"android-specific-configuration",children:"Android Specific Configuration"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"androidConfig"}),":","\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsxs)(e.p,{children:[(0,o.jsx)(e.strong,{children:"Notification Settings"}),":"]}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"notificationChannelId"})," (default: ",(0,o.jsx)(e.code,{children:"'audio_recording'"}),"): Custom notification channel ID"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"notificationChannelName"})," (default: ",(0,o.jsx)(e.code,{children:"'Audio Recording'"}),"): Display name for the notification channel"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"notificationChannelDescription"})," (default: ",(0,o.jsx)(e.code,{children:"'Recording controls and status'"}),"): Description for the notification channel"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"notificationPriority"})," (default: ",(0,o.jsx)(e.code,{children:"'high'"}),"): Priority level for notifications"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"notificationIcon"})," (optional): Custom notification icon resource name"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"notificationColor"})," (optional): Custom notification color in hex format"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsxs)(e.p,{children:[(0,o.jsx)(e.strong,{children:"Service Configuration"}),":"]}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"foregroundServiceType"})," (default: ",(0,o.jsx)(e.code,{children:"'microphone'"}),"): Type of foreground service"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"wakeLockEnabled"})," (default: ",(0,o.jsx)(e.code,{children:"true"}),"): Keep device awake during recording"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"stopWithTask"})," (default: ",(0,o.jsx)(e.code,{children:"true"}),"): Stop recording when app is killed"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(e.p,{children:"Example configuration with Android options:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-json",children:'{\n    "expo": {\n        "plugins": [\n            [\n                "@siteed/expo-audio-stream",\n                {\n                    "enablePhoneStateHandling": true,\n                    "enableNotifications": true,\n                    "enableBackgroundAudio": true,\n                    "iosBackgroundModes": {\n                        "useVoIP": false,\n                        "useAudio": false,\n                        "useProcessing": true\n                    },\n                    "iosConfig": {\n                        "backgroundProcessingTitle": "Audio Recording",\n                        "keepAliveInBackground": true\n                    },\n                    "androidConfig": {\n                        "notificationChannelId": "audio_recording",\n                        "notificationChannelName": "Audio Recording",\n                        "notificationChannelDescription": "Recording controls and status",\n                        "notificationPriority": "high",\n                        "notificationIcon": "ic_recording",\n                        "notificationColor": "#FF0000",\n                        "foregroundServiceType": "microphone",\n                        "wakeLockEnabled": true,\n                        "stopWithTask": true\n                    }\n                }\n            ]\n        ]\n    }\n}\n'})}),"\n",(0,o.jsx)(e.h3,{id:"android-manifest-permissions",children:"Android Manifest Permissions"}),"\n",(0,o.jsx)(e.p,{children:"The plugin automatically adds the following permissions to your Android manifest:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-xml",children:'\x3c!-- Base Permissions (Always Added) --\x3e\n<uses-permission android:name="android.permission.RECORD_AUDIO" />\n<uses-permission android:name="android.permission.WAKE_LOCK" />\n\n\x3c!-- Optional Permissions (Based on Configuration) --\x3e\n<uses-permission android:name="android.permission.POST_NOTIFICATIONS" />\n<uses-permission android:name="android.permission.READ_PHONE_STATE" />\n<uses-permission android:name="android.permission.FOREGROUND_SERVICE" />\n<uses-permission android:name="android.permission.FOREGROUND_SERVICE_MICROPHONE" />\n'})}),"\n",(0,o.jsx)(e.h3,{id:"android-service-components",children:"Android Service Components"}),"\n",(0,o.jsx)(e.p,{children:"The plugin also adds necessary service components to your Android manifest:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-xml",children:'\x3c!-- Recording Action Receiver --\x3e\n<receiver\n    android:name=".RecordingActionReceiver"\n    android:exported="false">\n    <intent-filter>\n        <action android:name="PAUSE_RECORDING" />\n        <action android:name="RESUME_RECORDING" />\n        <action android:name="STOP_RECORDING" />\n    </intent-filter>\n</receiver>\n\n\x3c!-- Audio Recording Service --\x3e\n<service\n    android:name=".AudioRecordingService"\n    android:enabled="true"\n    android:exported="false"\n    android:foregroundServiceType="microphone" />\n'})}),"\n",(0,o.jsx)(e.h3,{id:"app-store-submission-notes",children:"App Store Submission Notes"}),"\n",(0,o.jsx)(e.p,{children:"When submitting to the App Store, it's important to configure the background modes appropriately to avoid rejection:"}),"\n",(0,o.jsxs)(e.ol,{children:["\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsx)(e.p,{children:"If your app only needs background recording without playback:"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:["Set ",(0,o.jsx)(e.code,{children:"useAudio"})," to ",(0,o.jsx)(e.code,{children:"false"})]}),"\n",(0,o.jsxs)(e.li,{children:["Use ",(0,o.jsx)(e.code,{children:"useProcessing"})," instead for background operation"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsx)(e.p,{children:"If your app doesn't use VoIP features:"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:["Set ",(0,o.jsx)(e.code,{children:"useVoIP"})," to ",(0,o.jsx)(e.code,{children:"false"})]}),"\n",(0,o.jsxs)(e.li,{children:["Use alternative background modes like ",(0,o.jsx)(e.code,{children:"useProcessing"})," for background operation"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(e.p,{children:["Make sure to run ",(0,o.jsx)(e.code,{children:"npx expo prebuild"})," after modifying the plugin configuration in your app.json file."]}),"\n",(0,o.jsx)(e.h2,{id:"requesting-permissions",children:"Requesting Permissions"}),"\n",(0,o.jsx)(e.p,{children:"To request microphone permissions in your Expo project, you can use the following method:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-tsx",children:"import {\n    ExpoAudioStreamModule,\n} from '@siteed/expo-audio-stream'\n\nconst requestPermissions = async () => {\n    const { granted } =\n        await ExpoAudioStreamModule.requestPermissionsAsync()\n    if (granted) {\n        console.log('Microphone permissions granted')\n    } else {\n        console.log('Microphone permissions denied')\n    }\n}\n\nrequestPermissions();\n"})}),"\n",(0,o.jsxs)(e.p,{children:["Note that the plugin automatically configures the necessary permissions in your app's configuration, but you still need to request them at runtime using the ",(0,o.jsx)(e.code,{children:"requestPermissionsAsync()"})," method."]})]})}function u(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(t,{...n})}):t(n)}},8453:(n,e,i)=>{i.d(e,{R:()=>d,x:()=>l});var o=i(6540);const s={},r=o.createContext(s);function d(n){const e=o.useContext(r);return o.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:d(n.components),o.createElement(r.Provider,{value:e},n.children)}}}]);